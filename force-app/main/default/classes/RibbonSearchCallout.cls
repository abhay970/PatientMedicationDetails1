public with sharing class RibbonSearchCallout {
    @AuraEnabled
    public static Object getProviderInfo(Map<String, Object> mapParameter, String searchType) {
        Ribbon_Credential__mdt cs = [SELECT IsEndPointAvaliable__c, customerToken__c, endpoint__c FROM Ribbon_Credential__mdt WITH SECURITY_ENFORCED];
        String customerToken = cs.customerToken__c;
        String endpoint = cs.endpoint__c;
        System.debug('mapParameter:=>' + mapParameter);
        for(String key:new List<String>(mapParameter.keySet())){
            if(mapParameter.get(key)==''){
                mapParameter.remove(key);
            }
        }
        System.debug('mapParameter:=>' + mapParameter);
        System.debug('searchType=>' + searchType);
        boolean isEndPointAvailable = cs.IsEndPointAvaliable__c;
        System.debug('isEndPointAvailable>>' + isEndPointAvailable);
       
            System.debug('<<++Else--]]');

            Map<String,String> mapStr=new Map<String,String>{
                'searchType'=>searchType,'endpoint'=>endpoint,'customerToken'=>customerToken
            };
            return getListOfObjectIsEndpointNotAvailable(mapParameter, mapStr);
            // return getListOfObjectIsEndpointNotAvailable(mapParameter, searchType,endpoint,customerToken);
       
    }
   
    // public static Object getListOfObjectIsEndpointNotAvailable(Map<String, Object> mapParameter, String searchType,String endpoint,String customerToken){
    public static Object getListOfObjectIsEndpointNotAvailable(Map<String, Object> mapParameter, Map<String, String> mapStr){
        System.debug('mapStr:=> ' + mapStr);
        String searchType=(String)mapStr.get('searchType');
        String endpoint=(String)mapStr.get('endpoint');
        String customerToken=(String)mapStr.get('customerToken');
        // ==============================================================================================================================================
        List<Map<String, Object>> lstForJS = new List<Map<String, Object>>();
        String sampleJSON;
        if (searchType != null && searchType == 'ProviderSearch') {
            if (mapParameter.containsKey('Provider_type') && mapParameter.containsKey('Address') && mapParameter.containsKey('Name') && mapParameter.containsKey('Npi')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: ' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                //sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]}]}';
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                        
                    }
                }
            }
            else if (mapParameter.containsKey('Npi') && mapParameter.containsKey('Address') && mapParameter.containsKey('Name')) {
                String npi = (String) mapParameter.get('Npi');
                String provider_type = (String) mapParameter.get('Provider_type');
                String address = (String) mapParameter.get('Address');
                String name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?npi=' + npi + '&address=' + address + '&name=' + name;
                // sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]},{"npi":"123456711","first_name":"","middle_name":"","last_name":" Nelson","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Melbourne, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Dental Providers"}]},{"npi":"197456719","first_name":"","middle_name":"","last_name":"Martin","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Ballarat, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Optometry"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Harris","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Sydney, New South Wales, Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Chiropractic Providers"}]}]}';
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    // if(name == provider.last_name && address == provider.locations[0].address && npi==provider.npi){
                        lstForJS.add(createProviderMap(provider));
                    // }
                }
                //sampleJSON = '{"data":[{"npi":"1861664290","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"m","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
            }
            else if (mapParameter.containsKey('Npi')  && mapParameter.containsKey('Name')) {
                String npi = (String) mapParameter.get('Npi');
                String name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?name=' + name;
                // sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]},{"npi":"123456711","first_name":"","middle_name":"","last_name":" Nelson","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Melbourne, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Dental Providers"}]},{"npi":"197456719","first_name":"","middle_name":"","last_name":"Martin","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Ballarat, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Optometry"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Harris","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Sydney, New South Wales, Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Chiropractic Providers"}]}]}';
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"Js","last_name":"Doe","age":38,"gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    // if(name == provider.last_name && address == provider.locations[0].address && npi==provider.npi){
                        lstForJS.add(createProviderMap(provider));
                    // }
                }
                //sampleJSON = '{"data":[{"npi":"1861664290","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"m","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
            }
           
            else if (mapParameter.containsKey('Provider_type') && mapParameter.containsKey('Address') && mapParameter.containsKey('Name')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: ' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                //sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]}]}';
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                        
                    }
                }
            }
             else if (mapParameter.containsKey('Address') && mapParameter.containsKey('Name')) {
                String address = (String) mapParameter.get('Address');
                String name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?address=' + address + '&name=' + name;
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area": "Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('Name: ' + provider.last_name);
                    // if(name == provider.last_name && address == provider.locations[0].address){
                        lstForJS.add(createProviderMap(provider));
                    // }
                }
             }
             else if (mapParameter.containsKey('Provider_type')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: ' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                //sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]},{"npi":"123456711","first_name":"","middle_name":"","last_name":" Nelson","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Melbourne, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Dental Providers"}]},{"npi":"197456719","first_name":"","middle_name":"","last_name":"Martin","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Ballarat, Victoria,Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Optometry"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Harris","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Sydney, New South Wales, Australia"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Chiropractic Providers"}]}]}';
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                    }
                }
            } 
           
             else if (mapParameter.containsKey('Provider_type') && mapParameter.containsKey('Address')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: DEBA' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                //sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]}]}';
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                        
                    }
                }
            } 
             else if (mapParameter.containsKey('Provider_type') && mapParameter.containsKey('Npi')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: ' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                // sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]}]}';
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                        
                    }
                }
            } 
             else if (mapParameter.containsKey('Provider_type') && mapParameter.containsKey('Name')) {
                String provider_type = (String) mapParameter.get('Provider_type');
                System.debug('provider_type: ' + provider_type);
                endpoint = endpoint + '?provider_type=' + provider_type;
                sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Femal","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Jane","middle_name":"J","last_name":"Doe","age":43,"gender":"Male","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456719","first_name":"","middle_name":"","last_name":"Everly","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"Kingston, New York 12401"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing"}]}]}';
                
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // System.debug('NPI: ' + provider.last_name);
                    if(provider_type == provider.specialties[0].provider_type){
                        lstForJS.add(createProviderMap(provider));
                        
                    }
                }
            } 
              else if (mapParameter.containsKey('Name')) {
                String name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?name=' + name;
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area": "Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

             //sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('NPI: ' + provider.last_name); 
                    // if(name == provider.last_name){
                        lstForJS.add(createProviderMap(provider));
                        System.debug('provider Name  >>>>  ' + provider.gender);
                    // }
                }
            }              
            else if (mapParameter.containsKey('Npi')) {
                String npi = (String) mapParameter.get('Npi');
                endpoint = endpoint + '?npi=' + npi;
                sampleJSON = '{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area": "Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375340","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                //sampleJSON = '{"data":[{"npi":"123456798","first_name":"Addy","middle_name":"","last_name":"Kelley","age":43,"gender":"Female","provider_name":"Family Medicine Doctor","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('NPI: ' + provider.npi);
                    // if(npi == provider.npi){
                        lstForJS.add(createProviderMap(provider));
                        System.debug('provider Name  >>>>  ' + provider.npi);
                    // }
                }
            } 
            else if (mapParameter.containsKey('Address')) {
                String address = (String) mapParameter.get('Address');
                endpoint = endpoint + '?address=' + address;
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area": "Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(address == provider.locations[0].address){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else {
                endpoint = endpoint + '?npi=npiVaLUE&Address=usgf&speciality=varname';
            }
        } 
        // Search Location
        else if  (searchType != null && searchType == 'LocationSearch') {
            System.debug('>>>>>>>>>>>>>>>>>>>>>>');
 
             if (mapParameter.containsKey('Name')) {
                String name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?name=' + name;
                sampleJSON = '{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"care","age":43,"gender":"Male","phone":"4155146410","country":"US","city":"San Francisco","locations":[{"address":"184 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]},{"npi":"123456789","first_name":"Ames","middle_name":"","last_name":"Kendal","age":43,"gender":"Female","phone":"4241146410","country":"US","city":"New York","locations":[{"address":"New York, NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nnLocationSearch>>>> '+bundle);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                  
                    // if(name == provider.last_name){
                        lstForJS.add(createProviderMap(provider));
                        System.debug('provider Name  >>>>  ' + provider.name);
                    // }
                }
            }  
            else if (mapParameter.containsKey('Address')) {
                String address = (String) mapParameter.get('Address');
                endpoint = endpoint + '?address=' + address;
                sampleJSON='{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"Care","age":43,"gender":"m","phone":"4155146410","country":"US","city": "San Francisco","locations":[{"address":"185 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(address == provider.locations[0].address){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Country')) {
                String country = (String) mapParameter.get('Country');
                endpoint = endpoint + '?country=' + country;
                sampleJSON='{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"Care","age":43,"gender":"Male","phone":"4155146410","country":"US","city": "San Francisco","locations":[{"address":"185 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nnLocationSearchCountry>>>> '+bundle);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(country == provider.country){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Country') && mapParameter.containsKey('Name')) {
                String country = (String) mapParameter.get('Country');
                String name=(String) mapParameter.get('Name');
                endpoint = endpoint + '?country=' + country +'&name=' + name;
                sampleJSON='{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"Care","age":43,"gender":"Male","phone":"4155146410","country":"US","city": "San Francisco","locations":[{"address":"185 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nnLocationSearchCountry>>>> '+bundle);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    if(country == provider.country && name==provider.name){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    }
                }
            }
            else if (mapParameter.containsKey('Address') && mapParameter.containsKey('Name')) {
                String address = (String) mapParameter.get('Address');
                String name=(String) mapParameter.get('Name');
                endpoint = endpoint + '?address=' + address +'&name=' + name;
                sampleJSON='{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"Care","age":43,"gender":"Male","phone":"4155146410","country":"US","city": "San Francisco","locations":[{"address":"185 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nnLocationSearchCountry>>>> '+bundle);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    if(address == provider.locations[0].address && name==provider.name){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    }
                }
            }
            else if (mapParameter.containsKey('Address') && mapParameter.containsKey('Name') && mapParameter.containsKey('Country')) {
                String address = (String) mapParameter.get('Address');
                String name=(String) mapParameter.get('Name');
                String country= (String) mapParameter.get('Country');
                endpoint = endpoint + '?address=' + address +'&name=' + name + '&country=' + country;
                sampleJSON='{"data":[{"npi":"123456798","first_name":"Citymd","middle_name":"Urgent","last_name":"Care","age":43,"gender":"Male","phone":"4155146410","country":"US","city": "San Francisco","locations":[{"address":"185 Berry St # 130, San Francisco, CA 94107, US"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nnLocationSearchCountry>>>> '+bundle);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    if(address == provider.locations[0].address && name==provider.name && country==provider.country){
                        lstForJS.add(createProviderMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    }
                }
            }
            else {
                endpoint = endpoint + '?npi=npiVaLUE&Address=usgf&speciality=varname';
            }
        }
        else if(searchType != null && searchType == 'InsuranceSearch') {
            System.debug('>>>>>>>>>>>>>>>>>>>>>>InsurancesSearch');
             if (mapParameter.containsKey('Carrier_name') && mapParameter.containsKey('Plan_name')) {
                String carrier_name = (String) mapParameter.get('Carrier_name');
                // String plan_name = (String) mapParameter.get('Plan_name');
                endpoint = endpoint + '?carrier_name=' + carrier_name;
                sampleJSON ='{"data":[{"npi":"123456798","display_name":"Aetna - HealthFund Open Choice - PPO","country":"Australia","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"Victoria"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nurse"}]},{"npi":"123456718","display_name":"Aetna - HealthFund Open Choice - PPO","country":"USA","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
               // sampleJSON='{"data":[{"npi":"123496798","carrier_name":"Blue Cross Blue Shield of Illinois","plane_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"state":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
             
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // if(carrier_name == provider.carrier_name && plan_name == provider.plan_name){
                        lstForJS.add(createInsuranceMap(provider));
                        // System.debug('provider Name  >>>>  ' + provider.locations[0].state);
                    // }
                }
            }
            else if (mapParameter.containsKey('State') && mapParameter.containsKey('Carrier_name')) {
                String state = (String) mapParameter.get('State');
                // String carrier_name = (String) mapParameter.get('Carrier_name');
                endpoint = endpoint + '?state=' + state;
                sampleJSON ='{"data":[{"npi":"123456798","display_name":"Aetna - HealthFund Open Choice - PPO","country":"Australia","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"Victoria"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nurse"}]},{"npi":"123456718","display_name":"Aetna - HealthFund Open Choice - PPO","country":"USA","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
               // sampleJSON='{"data":[{"npi":"123496798","carrier_name":"Blue Cross Blue Shield of Illinois","plane_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"state":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
             
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    // if(state == provider.locations[0].state && carrier_name == provider.carrier_name){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('provider Name  >>>>  ' + provider.locations[0].state);
                    // }
                }
            }
             else if (mapParameter.containsKey('Carrier_name')) {
                String carrier_name = (String) mapParameter.get('Carrier_name');
                endpoint = endpoint + '?carrier_name=' + carrier_name;
                //sampleJSON = '{"data":[{"carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"State":"NY"}]}]}';
                sampleJSON ='{"data":[{"npi":"1861664294","first_name":"Jane","middle_name":"J","last_name":"Doe","age":38,"clinical_area":"Mental Health","gender":"m","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine3","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine4","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true},{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine5","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Nursing","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna1","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna2","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna3","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna4","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]},{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna5","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"156 Berry St # 101, New York, BR 88107, UK","address_details":{"street":"156 Berry St # 101","address_line_1":"101 Berry St","address_line_2":"# 101","city":"New York","state":"BR","zip":88107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4},{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, Colombia  , CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"Colombia","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]},{"npi":"1861664432","first_name":"James","middle_name":"","last_name":"denia","age":48,"gender":"f","ratings_count":20,"ratings_avg":9.8,"degrees":["MD"],"specialties":[{"uuid":"18d8ad26-7e5f-44ac-9afa-966efb375344","taxonomy_code":"207Q00000X","board_specialty":"Family Medicine","board_sub_specialty":"string","non_md_specialty":"string","non_md_sub_specialty":"None","provider_name":"Family Medicine Doctor","colloquial":"string","taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor","is_primary":true}],"languages":["english"],"educations":[{"education":{"name":"Stritch School of Medicine","uuid":"0b26c31a-d74a-4327-9702-57753b82a126"},"type":"string","year":2007}],"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"provider_types":["Doctor"],"locations":[{"uuid":"f38b9fd5-1e28-4f6e-953c-1e1493b68e21","name":"string","address":"185 Berry St # 130, San Francisco, CA 94107, US","address_details":{"street":"185 Berry St # 130","address_line_1":"185 Berry St","address_line_2":"# 130","city":"San Francisco","state":"CA","zip":94107},"latitude":37.7765973,"longitude":-122.3919488,"google_maps_link":"https://www.google.com/maps/@37.7765973-122.3919488?q=185%20Berry%20St%20%23%20130%2C%20SF%2C%20CA%2094107%2C%20US","phone_numbers":[{"phone":4155146410,"details":"primary"}],"faxes":[{"phone":2121234567,"details":"secondary","confidence":3}],"confidence":2,"insurances":[{"uuid":"d8addf29-1054-4ccb-b179-dda65f7fefdd","carrier_association":"Aetna","carrier_brand":"Aetna","carrier_name":"Aetna","state":"NY","plan_name":"Aetna HealthFund Open Choice","plan_type":"PPO","metal_level":"string","display_name":"Aetna - HealthFund Open Choice - PPO","network":"string","confidence":4,"category":"string","codes":["string"]}],"distance":0.4}],"online_profiles":[{"url":"string"}]}]}';

                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('NPI: ' + provider.carrier_name);
                    // if(carrier_name == provider.carrier_name){
                        lstForJS.add(createProviderMap(provider));
                        System.debug('carrier_name Name  >>>>  ' + provider.carrier_name);
                    // }
                }
            }  
            else if (mapParameter.containsKey('Plan_name')) {
                String plan_name = (String) mapParameter.get('Plan_name');
                endpoint = endpoint + '?plan_name=' + plan_name;
                sampleJSON ='{"data":[{"npi":"109456798", "display_name": "Aetna - HealthFund Open Choice - PPO", "carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}    ';
               // sampleJSON='{"data":[{"carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"State":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(plan_name == provider.plan_name){
                        lstForJS.add(createInsuranceMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('State')) {
                String state = (String) mapParameter.get('State');
                endpoint = endpoint + '?state=' + state;
                sampleJSON ='{"data":[{"npi":"123456798", "display_name": "Aetna - HealthFund Open Choice - PPO","country":"USA","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}    ';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                System.debug('nndata>>>> '+bundle.data);
                System.debug('nndatalocations>>>> '+bundle.data[0].locations[0]);
                System.debug('nndatastate>>>> '+bundle.data[0].locations[0].state);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   System.debug('insurace    ' + provider.locations[0]);
                    // if(state == provider.locations[0].state){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('provider Name  >>>>  ' + provider.locations[0].state);
                    // }
                }
            }
            else if (mapParameter.containsKey('State') && mapParameter.containsKey('Plan_name')) {
                String state = (String) mapParameter.get('State');
                String plan_name = (String) mapParameter.get('Plan_name');
                endpoint = endpoint + '?state=' + state + '&plan_name' + plan_name;
                sampleJSON ='{"data":[{"npi":"123456798", "display_name": "Aetna - HealthFund Open Choice - PPO","country":"USA","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}    ';
               // sampleJSON='{"data":[{"npi":"123496798","carrier_name":"Blue Cross Blue Shield of Illinois","plane_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"state":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
             
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    if(state == provider.locations[0].state && plan_name == provider.plan_name){
                        lstForJS.add(createInsuranceMap(provider));
                        // System.debug('provider Name  >>>>  ' + provider.locations[0].state);
                    }
                }
            }
            else if (mapParameter.containsKey('State') && mapParameter.containsKey('Plan_name') && mapParameter.containsKey('Carrier_name')) {
                String state = (String) mapParameter.get('State');
                String plan_name = (String) mapParameter.get('Plan_name');
                String carrier_name = (String) mapParameter.get('Carrier_name');
                endpoint = endpoint + '?state=' + state + '&plan_name' + plan_name + '&carrier_name'+ carrier_name;
                sampleJSON ='{"data":[{"npi":"123456798", "display_name": "Aetna - HealthFund Open Choice - PPO","country":"USA","carrier_association":"BCBS Association","carrier_brand":"BCBS","carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","plan_type":"PPO","category":"Medicare Advantage","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Doctor"}]}]}';
               // sampleJSON='{"data":[{"npi":"123496798","carrier_name":"Blue Cross Blue Shield of Illinois","plane_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"state":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
             
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    if(state == provider.locations[0].state && plan_name == provider.plan_name && carrier_name==provider.carrier_name){
                        lstForJS.add(createInsuranceMap(provider));
                        // System.debug('provider Name  >>>>  ' + provider.locations[0].state);
                    }
                }
            }
            else {
                endpoint = endpoint + '?npi=npiVaLUE&Address=usgf&speciality=varname';
            }

        }
        else if(searchType != null && searchType == 'ClinicalSearch') {
            System.debug('>>>>>>>>>>>>>>>>>>>>>>ClinicalSearch');
             if (mapParameter.containsKey('Condition') && mapParameter.containsKey('Treatment')) {
                String condition = (String) mapParameter.get('Condition');
                // String treatment = (String) mapParameter.get('Treatment');
                endpoint = endpoint + '?condition=' + condition;
                sampleJSON ='{"data":[{"npi":"123456798","clinical_area":"Nutrition","condition":"Sleep Disorders","treatment":"ACL Surgery","type":"providers","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                //sampleJSON='{"data":[{"carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"State":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(condition == provider.condition && treatment==provider.treatment){
                        lstForJS.add(createInsuranceMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Condition') && mapParameter.containsKey('Clinical_area')) {
                // String condition = (String) mapParameter.get('Condition');
                String clinical_area = (String) mapParameter.get('Clinical_area');
                endpoint = endpoint +'?clinical_area='+clinical_area;
                sampleJSON ='{"data":[{"npi":"123456798","clinical_area":"Nutrition","condition":"Sleep Disorders","treatment":"ACL Surgery","type":"providers","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                //sampleJSON='{"data":[{"carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"State":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(condition == provider.condition && clinical_area==provider.clinical_area){
                        lstForJS.add(createInsuranceMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Clinical_area')) {
                String clinical_area = (String) mapParameter.get('Clinical_area');
                endpoint = endpoint + '?clinical_area=' + clinical_area;
                sampleJSON = '{"data":[{"npi":"0099888776","clinical_area":"Nutrition","condition":"Sleep Disorders","treatment":"ACL Surgery","type":"providers","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]},{"npi":"0099888776","clinical_area":"Obstetrical area","condition":"nephrolithiasis","treatment":"shockwave lithotripsy","type":"providers","locations":[{"state":"UK"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('NPI: ' + provider.clinical_area);
                    // if(clinical_area == provider.clinical_area){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('clinical_area Name  >>>>  ' + provider.clinical_area);
                    // }
                }
            }  
            else if (mapParameter.containsKey('Condition')) {
                String condition = (String) mapParameter.get('Condition');
                endpoint = endpoint + '?condition=' + condition;
                sampleJSON ='{"data":[{"npi":"123456798","clinical_area":"Nutrition","condition":"Sleep Disorders","treatment":"ACL Surgery","type":"providers","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                //sampleJSON='{"data":[{"carrier_name":"Blue Cross Blue Shield of Illinois","plan_name":"BlueCare Direct","category":"Medicare Advantage","locations":[{"State":"NY"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(condition == provider.condition){
                        lstForJS.add(createInsuranceMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Treatment')) {
                String treatment = (String) mapParameter.get('Treatment');
                endpoint = endpoint + '?treatment=' + treatment;
               sampleJSON='{"data":[{"npi":"123456798","clinical_area":"Nutrition","condition":"Sleep Disorders","treatment":"ACL Surgery","type":"providers","locations":[{"state":"NY"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
               
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    
                    // if(treatment == provider.treatment){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('treatment >>>>  ' + provider.treatment);
                    // }
                }
            }
            else {
                endpoint = endpoint + '?npi=npiVaLUE&Address=usgf&speciality=varname';
            }
        }
        else if(searchType != null && searchType == 'OrganizationSearch') {
            System.debug('>>>>>>>>>>>>>>>>>>>>>>OrganizationSearch');
             if (mapParameter.containsKey('Name')) {
                String Name = (String) mapParameter.get('Name');
                endpoint = endpoint + '?name=' + name;
                sampleJSON ='{"data":[{"npi":"123456798","name":"Baptist Health (Jacksonville)","organization_types":"Health System","city":"New York","state":"FL","type":"providers","phone":"9042022000","locations":[{"address":"New York, NY","address_line_1":"841 Prudential Dr","address_line_2":"# 1601"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    System.debug('name: ' + provider.name);
                    // if(name == provider.name){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('clinical_area Name  >>>>  ' + provider.name);
                    // }
                }
            }  
            else if (mapParameter.containsKey('Address')) {
                String address = (String) mapParameter.get('Address');
                endpoint = endpoint + '?address=' + address;
                sampleJSON ='{"data":[{"npi":"123456798","name":"Baptist Health (Jacksonville)","organization_types":"Health System","city":"New York","state":"FL","type":"providers","phone":"9042022000","locations":[{"address":"New York, NY","address_line_1":"841 Prudential Dr","address_line_2":"# 1601"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                   // System.debug('NPI: ' + provider.locations[0].address);
                    // if(address==provider.locations[0].address){
                        lstForJS.add(createInsuranceMap(provider));
                        //System.debug('provider Name  >>>>  ' + provider.address);
                    // }
                }
            }
            else if (mapParameter.containsKey('Organization_types')) {
                String organization_types = (String) mapParameter.get('Organization_types');
                endpoint = endpoint + '?organization_types=' + organization_types;
                sampleJSON='{"data":[{"npi":"123456798","name":"Baptist Health (Jacksonville)","organization_types":"Health System","city":"New York","state":"FL","type":"providers","phone":"9042022000","locations":[{"address":"New York, NY","address_line_1":"841 Prudential Dr","address_line_2":"# 1601"}],"specialties":[{"taxonomy_1":"Allopathic & Osteopathic Physicians","taxonomy_2":"Family Medicine","taxonomy_3":"string","display":"Family Medicine","provider_type":"Docter"}]}]}';
                providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
               
                for (providerSearchWrapper.ProviderData provider : bundle.data) {
                    
                    // if(organization_types == provider.organization_types){
                        lstForJS.add(createInsuranceMap(provider));
                        System.debug('organization_types >>>>  ' + provider.organization_types);
                    // }
                }
            }
            else {
                endpoint = endpoint + '?npi=npiVaLUE&Address=usgf&speciality=varname';
            }

        }
        
        System.debug('Modified endpoint with NPI: ' + endpoint);
        // System.debug('customerToken>>' + customerToken);
        HttpRequest req = new HttpRequest();
        req.setEndpoint(endpoint);
        req.setMethod('GET');
        req.setHeader('accept', 'application/json');
        req.setHeader('Authorization', 'Bearer ' + customerToken);
        Http http = new Http();
        HttpResponse res = http.send(req);
        if (res.getStatusCode() == 200) {
            System.debug('inside 200');
            System.debug('Response: ' + res.getBody());
        } else if (res.getStatusCode() == 400) {
            System.debug('inside 400');
        } else if (res.getStatusCode() == 403) {
            System.debug('inside 403');
        } else {
            System.debug('inside else');
            System.debug('error message: ' + res.getStatusCode());
        }
        
        providerSearchWrapper bundle = (providerSearchWrapper) JSON.deserialize(sampleJSON, providerSearchWrapper.class);
        System.debug('lstForJS:=>' + lstForJS);
        return lstForJS;
        // ==============================================================================================================================
    }
    private static Map<String, Object> createProviderMap(providerSearchWrapper.ProviderData provider) {
        System.debug('Gender ==>'+provider.gender);
        System.debug('clinicalarea ==>'+provider.clinical_area);
        // mapstr.put('clinical_area', provider.clinical_area);

        System.debug('Name '+provider.first_name + ' ' + provider.middle_name + ' ' + provider.last_name);
        System.debug('Location ==>'+ provider.locations[0].address);
        System.debug('NPI ==>'+provider.npi);
        System.debug('country ==>'+provider.country);
        System.debug('phone ==>'+ provider.locations[0].phone_numbers[0].phone);
        System.debug('specialties ==>'+provider.specialties);
        System.debug('taxonomy_2 ==>'+provider.specialties[0].taxonomy_2);
        System.debug('board_specialty ==>'+provider.specialties[0].board_specialty);
        System.debug('provider_name ==>'+provider.specialties[0].provider_name);
        System.debug('display ==>'+provider.specialties[0].display);
        System.debug('provider_type ==>'+provider.specialties[0].provider_type);
        System.debug('Education ==>'+provider.educations[0].education.name);
        System.debug('carrier_association ==>'+provider.insurances[0].carrier_association);
        System.debug('carrier_brand ==>'+provider.insurances[0].carrier_brand);
        System.debug('carrier_name ==>'+provider.insurances[0].carrier_name);
        System.debug('state ==>'+provider.insurances[0].state);
        System.debug('Address211 ==>'+provider.locations[0].address_details.street);
        System.debug('Addressinsurace ==>'+provider.locations[0].insurances);


        Map<String, Object> mapstr = new Map<String, Object>();
        mapstr.put('name', provider.first_name + ' ' + provider.middle_name + ' ' + provider.last_name);
        mapstr.put('address', provider.locations[0].address);
        mapstr.put('gender', provider.gender);
        mapstr.put('clinical_area', provider.clinical_area);
        mapstr.put('npi', provider.npi);
        mapstr.put('age', provider.age);
        mapstr.put('country', provider.country);
        mapstr.put('phone', provider.locations[0].phone_numbers[0].phone);
        mapstr.put('city', provider.city);
        mapstr.put('provider_name', provider.provider_name);
        // bd
        List<Map<String, String>> lstSP=new List<Map<String, String>>();
        for(providerSearchWrapper.Specialty sp:provider.specialties){
            // System.debug('sptaxonomy_1 ==>'+sp.taxonomy_1);
            Map<String, String> obj=new Map<String, String>();
            obj.put('specialties_taxonomy_1', sp.taxonomy_1);
            obj.put('specialties_taxonomy_2', sp.taxonomy_2);
            obj.put('specialties_provider_name', sp.provider_name);
            obj.put('specialties_provider_type', sp.provider_type);
            obj.put('specialties_board_specialty', sp.board_specialty);
            obj.put('specialties_display',  sp.display);
            lstSP.add(obj);
        }
        System.debug('lstSP>>> '+lstSP);
        mapstr.put('specialties_bd', lstSP);
        // bd
        mapstr.put('specialties_taxonomy_1', provider.specialties[0].taxonomy_1);
        mapstr.put('specialties_taxonomy_2', provider.specialties[0].taxonomy_2);
        mapstr.put('specialties_provider_name', provider.specialties[0].provider_name);
        mapstr.put('specialties_provider_type', provider.specialties[0].provider_type);
        mapstr.put('specialties_board_specialty', provider.specialties[0].board_specialty);
        mapstr.put('specialties_display', provider.specialties[0].display);
       //  ins
       mapstr.put('provider_name', provider.provider_name);
    //   mapstr.put('specialties_bd', provider.specialties);
      List<Map<String, String>> lstIN=new List<Map<String, String>>();
      for(providerSearchWrapper.Insurance ins:provider.insurances){
        // System.debug('sptaxonomy_1 ==>'+sp.taxonomy_1);
        Map<String, String> obje=new Map<String, String>();
        obje.put('carrier_name', ins.carrier_name);
        obje.put('state', ins.state);
        obje.put('carrier_brand', ins.carrier_brand);
        obje.put('carrier_association', ins.carrier_association);
        obje.put('plan_name', ins.plan_name);
        obje.put('plan_type',  ins.plan_type);
        obje.put('display_name',  ins.display_name);
        lstIN.add(obje);
    }
    System.debug('lstIN>>> '+lstIN);
    mapstr.put('insurances_bd', lstIN);

    //for location start
    List<Map<String, String>> lstLoc=new List<Map<String, String>>();
    for(providerSearchWrapper.Location loc:provider.locations){
        Map<String, String> objes=new Map<String, String>();
        objes.put('address_details_street', loc.address_details.street);
        objes.put('address_details_address_line_1', loc.address_details.address_line_1);
        objes.put('address_details_address_line_2', loc.address_details.address_line_2);
        objes.put('address_details_city', loc.address_details.city);
        objes.put('address_details_state', loc.address_details.state);
        objes.put('address_details_zip', loc.address_details.zip);
        lstLoc.add(objes);
    }
    System.debug('lstLoc>>> '+lstLoc);
    mapstr.put('locations_bd', lstLoc);
    //for location end
       
        mapstr.put('carrier_name', provider.insurances[0].carrier_name);
        mapstr.put('state', provider.insurances[0].state);
        mapstr.put('carrier_brand', provider.insurances[0].carrier_brand);
        mapstr.put('carrier_association', provider.insurances[0].carrier_association);
        mapstr.put('plan_name', provider.insurances[0].plan_name);
        mapstr.put('plan_type', provider.insurances[0].plan_type);
        mapstr.put('display_name', provider.insurances[0].display_name);
        mapstr.put('edname', provider.educations[0].education.name);
        return mapstr;
    }
    private static Map<String, Object> createInsuranceMap(providerSearchWrapper.ProviderData provider) {
        Map<String, Object> mapstr = new Map<String, Object>();
        System.debug('carrier_name>>  '+provider.carrier_name);
        System.debug('plan_name=-=>>  '+provider.plan_name);
        mapstr.put('state', provider.locations[0].state);
        mapstr.put('address', provider.locations[0].address);
        mapstr.put('address_line_1', provider.locations[0].address_line_1);
        mapstr.put('address_line_2', provider.locations[0].address_line_2);


        List<Map<String, String>> lstINC=new List<Map<String, String>>();
        for(providerSearchWrapper.Location ins:provider.locations){
            Map<String, String> objes=new Map<String, String>();
            objes.put('address_details_street', ins.address_details.street);
            objes.put('address_details_address_line_1', ins.address_details.address_line_1);
            objes.put('address_details_address_line_2', ins.address_details.address_line_2);
            objes.put('address_details_city', ins.address_details.city);
            objes.put('address_details_state', ins.address_details.state);
            objes.put('address_details_zip', ins.address_details.zip);
            lstINC.add(objes);
        }
        System.debug('lstLlstINCoc>>> '+lstINC);
        mapstr.put('insurance_bd', lstINC);

        mapstr.put('carrier_name', provider.carrier_name);
        mapstr.put('plan_name', provider.plan_name);
        mapstr.put('display_name', provider.display_name);
        mapstr.put('plan_type', provider.plan_type);
        mapstr.put('category', provider.category);
        mapstr.put('carrier_association', provider.carrier_association);
        mapstr.put('carrier_brand', provider.carrier_brand);
        mapstr.put('npi', provider.npi);
        mapstr.put('gender', provider.gender);
        mapstr.put('clinical_area', provider.clinical_area);
        mapstr.put('condition', provider.condition);
        mapstr.put('treatment', provider.treatment);
        mapstr.put('type', provider.type);
        mapstr.put('name', provider.name);
        mapstr.put('organization_types', provider.organization_types);
        mapstr.put('city', provider.city);
        // mapstr.put('state', provider.state);
        mapstr.put('phone', provider.phone);
        mapstr.put('specialties_taxonomy_1', provider.specialties[0].taxonomy_1);
        mapstr.put('specialties_taxonomy_2', provider.specialties[0].taxonomy_2);
        mapstr.put('specialties_provider_type', provider.specialties[0].provider_type);
        mapstr.put('specialties_display', provider.specialties[0].display);
        return mapstr;
    }

    @AuraEnabled
    public static List<Object> getRibbonPicklist() {
        try {
            List<Map<String, String>> pickListValues = new List<Map<String, String>>();
            Schema.DescribeFieldResult pickList = RibbonPicklist__mdt.Ribbon_Provider_Types__c.getDescribe();
            for (Schema.PicklistEntry pickVal : pickList.getPicklistValues()) {
                Map<String, String> picklistValue = new Map<String, String>();
                picklistValue.put('label', pickVal.getValue());
                picklistValue.put('value', pickVal.getValue());
                pickListValues.add(picklistValue);
            }
            System.debug('pickListValues >>  ' + pickListValues);
            return pickListValues;
        } catch (Exception e) {
            throw new AuraHandledException(e.getMessage());
        }
    }
}
